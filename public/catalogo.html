<!DOCTYPE html>
<html lang="it">
  <head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="/css/style.css" />
    <title>Catalogo Biblioteca</title>
  </head>
  <body>
    <h1>Catalogo Libri</h1>
    <table border="1" id="tabellaLibri">
      <tr>
        <th>Titolo</th>
        <th>Autore</th>
        <th>Casa Editrice</th>
        <th>Genere</th>
      </tr>
    </table>

    <script type="module">
      import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

      const SUPABASE_URL = "https://zsyjukbcdbdwinaxytwa.supabase.co";
      const SUPABASE_ANON_KEY =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpzeWp1a2JjZGJkd2luYXh5dHdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkzNDE5MjgsImV4cCI6MjA3NDkxNzkyOH0.P1SFxz98FRCn4TnVRLmG_mmohkglGWQateic6G4vnxk";

      const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

      async function caricaLibri() {
        const { data: libri, error } = await supabase.from("libri").select("*");
        if (error) {
          console.error(error);
          return;
        }

        const tabella = document.getElementById("tabellaLibri");
        libri.forEach((l) => {
          let row = `<tr>
      <td>${l.titolo}</td>
      <td>${l.autore}</td>
      <td>${l.casa_editrice}</td>
      <td>${l.genere}</td>
    </tr>`;
          tabella.innerHTML += row;
        });
      }

      caricaLibri();
    </script>
  </body>
</html>
